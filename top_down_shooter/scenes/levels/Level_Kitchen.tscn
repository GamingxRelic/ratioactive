[gd_scene load_steps=25 format=3 uid="uid://bpghqtecw0775"]

[ext_resource type="Script" path="res://scripts/levels/Level.gd" id="1_rudie"]
[ext_resource type="Texture2D" uid="uid://1108xk5jyuw0" path="res://assets/levels/kitchen/kitchen.png" id="2_v8u7y"]
[ext_resource type="PackedScene" uid="uid://2a5hu5k24rwo" path="res://scenes/entities/Player/Player.tscn" id="3_e82cx"]
[ext_resource type="PackedScene" uid="uid://5dwbbxlj7ose" path="res://scenes/entities/drops/Dropped_Weapon.tscn" id="3_xwmu5"]
[ext_resource type="Texture2D" uid="uid://jxom078s0e1e" path="res://assets/levels/kitchen/spawn_room_door.png" id="3_yoyk7"]
[ext_resource type="Resource" uid="uid://cr0jvxbd4rlfh" path="res://resources/weapon/dev_pistol.tres" id="4_7nxjs"]
[ext_resource type="Script" path="res://scripts/camera/Camera.gd" id="4_l5xot"]
[ext_resource type="PackedScene" uid="uid://ba3xecoe67obj" path="res://scenes/UI/Game_UI.tscn" id="5_jo7qs"]
[ext_resource type="Script" path="res://scripts/levels/kitchen/Kitchen_Spawn_Room_Door.gd" id="6_bemgq"]
[ext_resource type="PackedScene" uid="uid://dpb1nr8xulbbn" path="res://scenes/map/spawners/Basic_Enemy_Spawner.tscn" id="7_8l10p"]
[ext_resource type="PackedScene" uid="uid://co5s2oouy6v45" path="res://scenes/map/buyables/Wall_Gun.tscn" id="8_po6n5"]
[ext_resource type="Resource" uid="uid://ckrus8b3wgwyu" path="res://resources/weapon/mini_pistol.tres" id="9_7phh0"]
[ext_resource type="Texture2D" uid="uid://dvbxdkwctdo0r" path="res://assets/levels/kitchen/broom.png" id="10_spk4s"]
[ext_resource type="PackedScene" uid="uid://tiv3237hpynr" path="res://scenes/map/buyables/Door.tscn" id="11_0nv45"]
[ext_resource type="Texture2D" uid="uid://dj2k0s6rm887x" path="res://assets/levels/kitchen/spawn_room_cheddar.png" id="11_on8c2"]
[ext_resource type="Texture2D" uid="uid://c3qyhhlat86ia" path="res://assets/levels/kitchen/spawn_room_cheddar-shadow.png" id="13_rebs1"]
[ext_resource type="Texture2D" uid="uid://ctyfpuyb8iwwq" path="res://assets/levels/kitchen/portraits.png" id="14_r106h"]
[ext_resource type="Texture2D" uid="uid://dpxff6thyo1wc" path="res://assets/levels/kitchen/outlet.png" id="15_arh0t"]

[sub_resource type="CircleShape2D" id="CircleShape2D_uam0c"]
radius = 21.0238

[sub_resource type="OccluderPolygon2D" id="OccluderPolygon2D_aovuk"]
polygon = PackedVector2Array(-173, 64, -122, 7, -121, 12, -171, 67)

[sub_resource type="NavigationPolygon" id="NavigationPolygon_jcawh"]
vertices = PackedVector2Array(-264, 87.0637, -264, -19, -254, -2, -242, 87, 265, 192, -120, 193, -120, 73, 264, -93, -120, 12, -120, -93, -171, 70, -136, 73, -136, 110, -233, 110, -180, 67, -184, 58, -214, -13, -136, 6, -136, -46, -217, -26, -264, -22, -264, -46, -220, -28, -258, -18)
polygons = Array[PackedInt32Array]([PackedInt32Array(0, 1, 2, 3), PackedInt32Array(4, 5, 6, 7), PackedInt32Array(8, 9, 7), PackedInt32Array(10, 8, 7, 6, 11), PackedInt32Array(11, 12, 13, 10), PackedInt32Array(14, 10, 13, 3), PackedInt32Array(14, 3, 2, 15), PackedInt32Array(15, 2, 16, 17), PackedInt32Array(18, 17, 16, 19), PackedInt32Array(20, 21, 18, 22), PackedInt32Array(22, 23, 20), PackedInt32Array(18, 19, 22)])
outlines = Array[PackedVector2Array]([PackedVector2Array(-136, -46, -264, -46, -264, -22, -258, -18, -220, -28, -217, -26, -214, -13, -254, -2, -264, -19, -264, 87.0637, -242, 87, -233, 110, -136, 110, -136, 73, -120, 73, -120, 193, 265, 192, 264, -93, -120, -93, -120, 12, -171, 70, -180, 67, -184, 58, -136, 6)])

[sub_resource type="Animation" id="Animation_il0sj"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("DirectionalLight2D:energy")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.05]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Player:process_mode")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Game_UI/CanvasLayer:visible")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}

[sub_resource type="Animation" id="Animation_xs37p"]
resource_name = "reveal_map"
length = 1.6
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("DirectionalLight2D:energy")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1.5),
"transitions": PackedFloat32Array(1.41421, 1.41421),
"update": 0,
"values": [1.5, 0.05]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Player:process_mode")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [4, 0]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Game_UI/CanvasLayer:visible")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 1.6),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [false, true]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_yfabn"]
_data = {
"RESET": SubResource("Animation_il0sj"),
"reveal_map": SubResource("Animation_xs37p")
}

[node name="Level_Kitchen" type="Node2D"]
script = ExtResource("1_rudie")

[node name="Entities" type="Node2D" parent="."]

[node name="Dropped_Weapon" parent="Entities" instance=ExtResource("3_xwmu5")]
position = Vector2(-213, 42)
weapon_res = ExtResource("4_7nxjs")

[node name="Ground" type="Node2D" parent="."]

[node name="Floor" type="Sprite2D" parent="Ground"]
z_index = -1
texture = ExtResource("2_v8u7y")

[node name="Spawn_Room" type="Node2D" parent="Ground"]

[node name="Spawners" type="Node2D" parent="Ground/Spawn_Room"]

[node name="Basic_Enemy_Spawner" parent="Ground/Spawn_Room/Spawners" instance=ExtResource("7_8l10p")]
position = Vector2(-257, -37)

[node name="Wall_Gun" parent="Ground/Spawn_Room" instance=ExtResource("8_po6n5")]
position = Vector2(-190, -52)
weapon_res = ExtResource("9_7phh0")

[node name="Buyable_Component" parent="Ground/Spawn_Room/Wall_Gun" index="2"]
position = Vector2(0, 8)

[node name="Decor" type="Node2D" parent="Ground/Spawn_Room"]

[node name="Cheese" parent="Ground/Spawn_Room/Decor" instance=ExtResource("11_0nv45")]

[node name="Sprite2D" parent="Ground/Spawn_Room/Decor/Cheese" index="0"]
top_level = true
z_index = 3
texture = ExtResource("11_on8c2")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Ground/Spawn_Room/Decor/Cheese/Buyable_Component" index="0"]
position = Vector2(74.0006, 151)
shape = SubResource("CircleShape2D_uam0c")

[node name="Text_Label_Component" parent="Ground/Spawn_Room/Decor/Cheese" index="2"]
z_index = 4
offset_left = -155.0
offset_top = 70.0
offset_right = -155.0
offset_bottom = 70.0

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="Ground/Spawn_Room/Decor/Cheese"]
polygon = PackedVector2Array(-170, 69, -169, 75, -136, 89, -136, 73, -155, 45, -172, 63)

[node name="Sprite_Shadow" type="Sprite2D" parent="Ground/Spawn_Room/Decor/Cheese"]
texture = ExtResource("13_rebs1")

[node name="Door" type="StaticBody2D" parent="Ground/Spawn_Room/Decor"]
z_index = 3
script = ExtResource("6_bemgq")

[node name="Sprite2D" type="Sprite2D" parent="Ground/Spawn_Room/Decor/Door"]
light_mask = 2
texture = ExtResource("3_yoyk7")

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="Ground/Spawn_Room/Decor/Door"]
position = Vector2(-1, -4)
polygon = PackedVector2Array(-173, 64, -122, 7, -121, 12, -171, 67)

[node name="Area2D" type="Area2D" parent="Ground/Spawn_Room/Decor/Door"]
visible = false
collision_layer = 0
collision_mask = 2

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="Ground/Spawn_Room/Decor/Door/Area2D"]
polygon = PackedVector2Array(-193.765, 24.855, -188, 19, -189, 14, -185, 10, -182, 14, -132, -43, -126, -38, -123, 3, -174, 60)

[node name="LightOccluder2D" type="LightOccluder2D" parent="Ground/Spawn_Room/Decor/Door"]
position = Vector2(-1, -4)
occluder = SubResource("OccluderPolygon2D_aovuk")

[node name="Broom" type="StaticBody2D" parent="Ground/Spawn_Room/Decor"]
collision_layer = 2
collision_mask = 0

[node name="Sprite2D" type="Sprite2D" parent="Ground/Spawn_Room/Decor/Broom"]
clip_children = 2
z_index = 6
texture = ExtResource("10_spk4s")

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="Ground/Spawn_Room/Decor/Broom"]
polygon = PackedVector2Array(-254, -2, -218, -12, -221, -26, -233, -46, -264, -46, -264, -22, -258, -18)

[node name="Can" type="StaticBody2D" parent="Ground/Spawn_Room/Decor"]

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="Ground/Spawn_Room/Decor/Can"]
polygon = PackedVector2Array(-241, 101, -237, 110, -264, 110, -264, 89, -248, 89, -241, 96)

[node name="Paintings" type="Sprite2D" parent="Ground/Spawn_Room/Decor"]
texture = ExtResource("14_r106h")

[node name="Outlet" type="Sprite2D" parent="Ground/Spawn_Room/Decor"]
texture = ExtResource("15_arh0t")

[node name="Wall_Colliders" type="Node2D" parent="Ground"]

[node name="Spawn_Room_Walls" type="StaticBody2D" parent="Ground/Wall_Colliders"]

[node name="Upper" type="CollisionPolygon2D" parent="Ground/Wall_Colliders/Spawn_Room_Walls"]
polygon = PackedVector2Array(-136, -46, -136, -60, -264, -60, -264, -46)

[node name="Left" type="CollisionPolygon2D" parent="Ground/Wall_Colliders/Spawn_Room_Walls"]
polygon = PackedVector2Array(-264, -60, -276, -60, -276, 125, -264, 125)

[node name="Bottom" type="CollisionPolygon2D" parent="Ground/Wall_Colliders/Spawn_Room_Walls"]
polygon = PackedVector2Array(-264, 110, -264, 125, -136, 125, -136, 110)

[node name="Upper_Right" type="CollisionPolygon2D" parent="Ground/Wall_Colliders/Spawn_Room_Walls"]
polygon = PackedVector2Array(-136, 12, -130, 15, -120, 12, -120, -107, -136, -107)

[node name="Lower_Right" type="CollisionPolygon2D" parent="Ground/Wall_Colliders/Spawn_Room_Walls"]
polygon = PackedVector2Array(-136, 74, -120, 74, -120, 212, -136, 212)

[node name="Kitchen_Walls" type="StaticBody2D" parent="Ground/Wall_Colliders"]

[node name="Upper" type="CollisionPolygon2D" parent="Ground/Wall_Colliders/Kitchen_Walls"]
polygon = PackedVector2Array(-120, -107, -120, -93, 264, -93, 264, -107, -120, -107)

[node name="Right" type="CollisionPolygon2D" parent="Ground/Wall_Colliders/Kitchen_Walls"]
polygon = PackedVector2Array(264, -107, 264, 212, 283, 212, 283, -107)

[node name="Lower" type="CollisionPolygon2D" parent="Ground/Wall_Colliders/Kitchen_Walls"]
polygon = PackedVector2Array(264, 192, 264, 212, -120, 212, -120, 192)

[node name="NavigationRegion2D" type="NavigationRegion2D" parent="Ground"]
navigation_polygon = SubResource("NavigationPolygon_jcawh")

[node name="Player" parent="." instance=ExtResource("3_e82cx")]
position = Vector2(-225, 60)

[node name="RemoteTransform2D" type="RemoteTransform2D" parent="Player"]
remote_path = NodePath("../../Camera2D")

[node name="Camera2D" type="Camera2D" parent="."]
position = Vector2(-225, 60)
zoom = Vector2(7, 7)
script = ExtResource("4_l5xot")

[node name="Game_UI" parent="." instance=ExtResource("5_jo7qs")]

[node name="DirectionalLight2D" type="DirectionalLight2D" parent="."]
energy = 0.05
blend_mode = 1

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_yfabn")
}

[node name="Wave_Intermission_Timer" type="Timer" parent="."]
wait_time = 5.0
one_shot = true

[node name="Wave_Countdown_Timer" type="Timer" parent="."]

[connection signal="body_entered" from="Ground/Spawn_Room/Decor/Door/Area2D" to="Ground/Spawn_Room/Decor/Door" method="_on_area_2d_body_entered"]
[connection signal="body_exited" from="Ground/Spawn_Room/Decor/Door/Area2D" to="Ground/Spawn_Room/Decor/Door" method="_on_area_2d_body_exited"]
[connection signal="animation_finished" from="AnimationPlayer" to="." method="_on_animation_player_animation_finished"]
[connection signal="timeout" from="Wave_Intermission_Timer" to="." method="_on_wave_intermission_timer_timeout"]
[connection signal="timeout" from="Wave_Countdown_Timer" to="." method="_on_wave_countdown_timer_timeout"]

[editable path="Ground/Spawn_Room/Wall_Gun"]
[editable path="Ground/Spawn_Room/Decor/Cheese"]
[editable path="Game_UI"]
